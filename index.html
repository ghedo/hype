<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pktizr &mdash; pktizr 0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="pktizr 0.0 documentation" href="#" />
    <link rel="next" title="bin library" href="lua_bin.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="lua_bin.html" title="bin library"
             accesskey="N">next</a> |</li>
        <li><a href="#">pktizr 0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="pktizr">
<h1>pktizr<a class="headerlink" href="#pktizr" title="Permalink to this headline">¶</a></h1>
<a class="reference external image-reference" href="https://travis-ci.org/ghedo/pktizr"><img alt="https://travis-ci.org/ghedo/pktizr.png" src="https://travis-ci.org/ghedo/pktizr.png" /></a>
<p><a class="reference external" href="https://ghedo.github.io/pktizr/">pktizr</a> is a command-line packet generator and analyzer. It lets you generate
custom IP/ICMP/TCP/UDP packets, send them over the network and analyze replies
using Lua scripts.</p>
<p>Among other things, pktizr can be used to test firewall/IDS rules, perform
host discovery, port scanning and OS fingerprinting, test network performance
and so on.</p>
<p>pktizr is fully asynchronous, meaning that it has separate transmit and receive
threads and Lua contexts. The &#8220;sending&#8221; part of a script can&#8217;t communicate with
the &#8220;receiving&#8221; part.</p>
<p>This makes it possible for pktizr to send packets as fast as possible without the
need to synchronously wait for replies, and send as many packets as needed
without worrying about memory exhaustion since it doesn&#8217;t need to keep track of
sent packets. However this makes writing scripts a little bit trickier.</p>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>Under the <a class="reference external" href="https://github.com/ghedo/pktizr/tree/master/scripts">scripts</a> directory you can find some example scripts. To
run a script you need to specify a list of target hosts (e.g. <cite>192.168.1.0/24</cite>),
a port range (e.g. <cite>1-65535</cite>) and obviously the script you want to run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo pktizr 192.168.1.0/24 -p <span class="m">1</span> -S scripts/ping.lua
</pre></div>
</div>
<p>This will run the <cite>ping.lua</cite> script against all the hosts on the 192.168.0/24
network. The script simply sends out ICMP echo requests like the <cite>ping(8)</cite>
utility does, and can be used to discover active hosts from a set of IP ranges.</p>
<p>The port range (specified with the <cite>-p</cite> option) is <cite>1</cite>, since we only want to
send a single packet per host:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo pktizr 192.168.1.0/24 -p 1-65535 -S scripts/syn.lua
</pre></div>
</div>
<p>The <cite>syn.lua</cite> script sends out TCP SYN packets and can be used to discover open
ports on target hosts. In this case the port range is <cite>1-65353</cite> which means all
ports on the targets will be scanned.</p>
<p>By default pktizr will process the target IP addresses and ports in order, but
it can also process them in random order in order to avoid overwhelming target
networks/hosts. This is enabled by using the <cite>-R</cite> option.</p>
<p>Note that by default pktizr sends packet at a rate of 100 packets per second, in
order to avoid flooding the local network or the target hosts. You can specify a
different value using the <cite>-r</cite> command-line option:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo pktizr 192.168.1.0/24 -p 1-65535 -S scripts/syn.lua -r 1000
</pre></div>
</div>
<p>This will send 1000 packets per second instead. To disable rate limiting, the
value <cite>0</cite> (which means &#8220;send packets as fast as possible&#8221;) can be used (<strong>use
this option with caution</strong>):</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo pktizr 192.168.1.0/24 -p 1-65535 -S scripts/syn.lua -r 0
</pre></div>
</div>
<p>Scripts can do more than simply sending out single packets, they can also
complete TCP connections and interact with applications on the target hosts.</p>
<p>However, since pktizr and the local system&#8217;s networking stack are independent,
they can interfere with each other. For example when the local system receives
a TCP SYN+ACK packet from a remote target, it automatically responds with a RST
packet that will kill the connection before pktizr can do anything with it.</p>
<p>Because of this, it&#8217;s recommended to assign to pktizr a separate IP address
using the <cite>&#8211;local-addr</cite> option:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo pktizr 192.168.1.0/24 -p <span class="m">80</span> -S scripts/http.lua -l 192.168.1.123
</pre></div>
</div>
<p>This value will be then accessible to scripts via the Lua API. Note that the
address chosen must be on the same local subnet and not used by any other
system.</p>
<p>See the <a class="reference external" href="https://ghedo.github.io/pktizr/pktizr.html">man page</a> for more information.</p>
</div>
<div class="section" id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><cite>liblua5.1/5.2/jit</cite></li>
<li><cite>liburcu</cite></li>
</ul>
</div>
<div class="section" id="building">
<h2>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h2>
<p>pktizr is distributed as source code. Build with:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>./bootstrap.py
<span class="nv">$ </span>./waf configure
<span class="nv">$ </span>./waf build
</pre></div>
</div>
</div>
<div class="section" id="fuzzing">
<h2>Fuzzing<a class="headerlink" href="#fuzzing" title="Permalink to this headline">¶</a></h2>
<p>pktizr&#8217;s packet decoder can be tested by using the afl fuzzer as follows:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ CC</span><span class="o">=</span>afl-gcc ./waf configure --sanitize<span class="o">=</span>address
<span class="nv">$ </span>./waf build_fuzz
<span class="nv">$ </span>afl-fuzz -i tests/ -o results/ -m none build/pkt_fuzz @@
</pre></div>
</div>
</div>
<div class="section" id="copyright">
<h2>Copyright<a class="headerlink" href="#copyright" title="Permalink to this headline">¶</a></h2>
<p>Copyright (C) 2015 Alessandro Ghedini &lt;<a class="reference external" href="mailto:alessandro&#37;&#52;&#48;ghedini&#46;me">alessandro<span>&#64;</span>ghedini<span>&#46;</span>me</a>&gt;</p>
<p>See <a class="reference external" href="https://github.com/ghedo/pktizr/tree/master/COPYING">COPYING</a> for the license.</p>
</div>
<div class="section" id="lua-api">
<h2>Lua API<a class="headerlink" href="#lua-api" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="lua_bin.html">bin library</a><ul>
<li class="toctree-l2"><a class="reference internal" href="lua_bin.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="lua_bin.html#format">Format</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lua_bit.html">bit library</a><ul>
<li class="toctree-l2"><a class="reference internal" href="lua_bit.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lua_pkt.html">pkt library</a><ul>
<li class="toctree-l2"><a class="reference internal" href="lua_pkt.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lua_std.html">std library</a><ul>
<li class="toctree-l2"><a class="reference internal" href="lua_std.html#functions">Functions</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">pktizr</a><ul>
<li><a class="reference internal" href="#getting-started">Getting Started</a></li>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li><a class="reference internal" href="#building">Building</a></li>
<li><a class="reference internal" href="#fuzzing">Fuzzing</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
<li><a class="reference internal" href="#lua-api">Lua API</a></li>
</ul>
</li>
</ul>

  <h4>Next topic</h4>
  <p class="topless"><a href="lua_bin.html"
                        title="next chapter">bin library</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="lua_bin.html" title="bin library"
             >next</a> |</li>
        <li><a href="#">pktizr 0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Alessandro Ghedini.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>